<h>1.1 Метод ближайшего соседа</h>

Рассмотрим задачу kNN при k = 1 на языке R.

Алгоритм

Для классификации каждого объекта тестовой выборки нужно пошагово произвести ряд следующих операций:

1.Расчёт расстояния до каждого объекта из данной тестовой выборки.

2.Поиск нужного объекта из выборки, от которого растояние до классифицируемого объекта является минимальным.

Класс классифицируемого объекта — это класс, ближайшего к нему объекта из обучающей выборки

3.Введём число точек в тестовой выборке (n). 

4.Теперь создадим n точек с ограничениями по длине и ширине лепестка при помощи cbind и runif. 

5.Отбразим тренировочную выборку. 

6.Рисуя тестовые точки, запускаем алгоритм 1NN для определения принадлежности одному из трёх существующих классов. 

7.В самой функции 1NN ищем ближайшего по Евклидову расстоянию соседа для текущей точки и возвращаем вид ириса для неё же. 

На рисунке ниже показан результат 10 случайно выбранных точек

![Image alt](https://github.com/Ragnarok7861/Victor/blob/master/1nn_10points.png)


Рассмотрим программную реализацию функции 1NN на языке программирования R.
```
oneNN <- function(set, point){
  
  ## возьмём за ближайшего соседа первую точку в наборе
  min_distance <- distance_of_Euclid(set[1, 1:2], point)
  number_of_nearest <- 1
  
  ## попробуем найти соседа ближе
  for(i in 2:N){
    if (distance_of_Euclid(set[i, 1:2], point) < min_distance){
      min_distance <- distance_of_Euclid(set[i, 1:2], point)
      number_of_nearest <- i
    }
  }
  
  ## возвращаем вид ириса ближайшего соседа
  return(set[number_of_nearest, 3])
  }
  ```
  Обратим внимание на карту классификации для 1NN
  
![Image alt](https://github.com/Ragnarok7861/Victor/blob/master/1nn_map.png)

Алгорим k ближайших соседей

Для классифицирования каждого объекта данной выборки требуется пошагово произвести  ряд следующих операций:

1.Вычислить расстояние до каждого из объектов обучающей выборки.

2.Отобрать k объектов обучающей выборки, расстояние до которых минимально.

Класс классифицируемого объекта — это класс, наиболее часто встречающийся среди k ближайших соседей

3.Работа алгоритма k-ближайших соседей начинается с сортировки всех элементов обучающей выборки по расстоянию относительно тестовой точки, далее отправляем в саму функцию kNN обучающую выборку, k и точку, которую нужно классифицировать. 

4.Проходим циклом от 1 до k и смотрим, каких ирисов больше. 

5.Относим классифицируемую точку к тому классу, которого среди этих k элементов больше. 

Ниже можем увидеть код на языке R:
```
## сортировка тренировочного набора
ordered_set <- sort(train_set, points[i, 1:2])
## функция kNN
kNN <- function(k, ordered_arr){
  
  col_class <- dim(ordered_arr)[2]
  
  class <- names(which.max(table(ordered_arr[1:k, col_class])))
  
  return(class)
  
}
```


